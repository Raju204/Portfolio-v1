<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel — Raju Maurya Portfolio</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Inter', sans-serif;
            background: #0f0f17;
            color: #e0e0e0;
            min-height: 100vh;
        }

        /* ===== LOGIN SCREEN ===== */
        .login-screen {
            position: fixed; inset: 0; background: #0f0f17;
            display: flex; align-items: center; justify-content: center;
            z-index: 10000;
        }
        .login-screen.hidden { display: none; }
        .login-box {
            background: #1a1a2e; border: 1px solid rgba(240,192,64,.15);
            border-radius: 20px; padding: 48px 40px; width: 400px; max-width: 90%;
            text-align: center;
        }
        .login-box .logo {
            font-size: 2.5rem; color: #f0c040; margin-bottom: 8px;
        }
        .login-box h2 {
            font-size: 1.4rem; margin-bottom: 6px;
        }
        .login-box .sub { color: #888; font-size: .85rem; margin-bottom: 30px; }
        .login-box input {
            width: 100%; padding: 14px 18px; border-radius: 10px;
            border: 1px solid rgba(240,192,64,.15); background: #0f0f17;
            color: #e0e0e0; font-size: .95rem; outline: none;
            transition: border-color .3s;
        }
        .login-box input:focus { border-color: #f0c040; }
        .login-box .login-btn {
            width: 100%; padding: 14px; border: none; border-radius: 10px;
            background: linear-gradient(135deg, #f0c040, #e06040);
            color: #0a0a0f; font-size: .95rem; font-weight: 600;
            cursor: pointer; margin-top: 16px; transition: transform .2s, box-shadow .2s;
        }
        .login-box .login-btn:hover {
            transform: translateY(-2px); box-shadow: 0 8px 24px rgba(240,192,64,.3);
        }
        .login-error {
            color: #e06040; font-size: .82rem; margin-top: 12px; display: none;
        }
        .login-error.show { display: block; }

        /* ===== ADMIN LAYOUT ===== */
        .admin-wrapper { display: none; }
        .admin-wrapper.show { display: flex; min-height: 100vh; }

        /* ===== SIDEBAR ===== */
        .sidebar {
            width: 260px; background: #1a1a2e; border-right: 1px solid rgba(240,192,64,.08);
            padding: 24px 0; position: fixed; top: 0; bottom: 0; overflow-y: auto;
            z-index: 100;
        }
        .sidebar-header {
            padding: 0 20px 24px; border-bottom: 1px solid rgba(240,192,64,.08);
            margin-bottom: 16px;
        }
        .sidebar-header h3 {
            font-size: 1.1rem;
            background: linear-gradient(135deg, #f0c040, #e06040);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .sidebar-header p { font-size: .75rem; color: #666; margin-top: 4px; }
        .sidebar-nav { list-style: none; }
        .sidebar-nav li a {
            display: flex; align-items: center; gap: 12px;
            padding: 12px 20px; color: #888; font-size: .88rem;
            text-decoration: none; transition: all .2s; border-left: 3px solid transparent;
        }
        .sidebar-nav li a:hover, .sidebar-nav li a.active {
            background: rgba(240,192,64,.05); color: #f0c040;
            border-left-color: #f0c040;
        }
        .sidebar-nav li a i { width: 20px; text-align: center; font-size: .9rem; }
        .sidebar-footer {
            position: absolute; bottom: 0; width: 100%;
            padding: 16px 20px; border-top: 1px solid rgba(240,192,64,.08);
        }
        .sidebar-footer .logout-btn {
            width: 100%; padding: 10px; border: 1px solid rgba(224,96,64,.3);
            background: transparent; color: #e06040; border-radius: 8px;
            cursor: pointer; font-size: .85rem; transition: all .2s;
        }
        .sidebar-footer .logout-btn:hover { background: rgba(224,96,64,.1); }

        /* ===== MAIN CONTENT ===== */
        .main-content {
            margin-left: 260px; flex: 1; padding: 32px 40px; min-height: 100vh;
        }

        /* ===== TOP BAR ===== */
        .topbar {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 32px; flex-wrap: wrap; gap: 16px;
        }
        .topbar h1 { font-size: 1.6rem; font-weight: 700; }
        .topbar-actions { display: flex; gap: 12px; flex-wrap: wrap; }
        .topbar-actions .btn {
            padding: 10px 20px; border-radius: 10px; font-size: .85rem; font-weight: 600;
            cursor: pointer; border: none; transition: all .2s; display: inline-flex;
            align-items: center; gap: 6px;
        }
        .btn-save {
            background: linear-gradient(135deg, #f0c040, #e06040); color: #0a0a0f;
        }
        .btn-save:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(240,192,64,.3); }
        .btn-preview {
            background: rgba(240,192,64,.1); color: #f0c040;
            border: 1px solid rgba(240,192,64,.2) !important;
        }
        .btn-preview:hover { background: rgba(240,192,64,.15); }
        .btn-reset {
            background: rgba(224,96,64,.1); color: #e06040;
            border: 1px solid rgba(224,96,64,.2) !important;
        }
        .btn-reset:hover { background: rgba(224,96,64,.15); }

        /* ===== PANELS ===== */
        .panel { display: none; }
        .panel.active { display: block; }

        /* ===== FORM ELEMENTS ===== */
        .form-section {
            background: #1a1a2e; border: 1px solid rgba(240,192,64,.08);
            border-radius: 16px; padding: 28px; margin-bottom: 24px;
        }
        .form-section h3 {
            font-size: 1.1rem; margin-bottom: 20px; color: #f0c040;
            display: flex; align-items: center; gap: 8px;
        }
        .form-section h3 i { font-size: .9rem; opacity: .7; }
        .form-group { margin-bottom: 18px; }
        .form-group label {
            display: block; font-size: .82rem; color: #999; margin-bottom: 6px;
            font-weight: 500; text-transform: uppercase; letter-spacing: .5px;
        }
        .form-group input, .form-group textarea, .form-group select {
            width: 100%; padding: 12px 16px; border-radius: 10px;
            border: 1px solid rgba(240,192,64,.1); background: #0f0f17;
            color: #e0e0e0; font-size: .9rem; font-family: inherit;
            outline: none; transition: border-color .3s;
        }
        .form-group input:focus, .form-group textarea:focus {
            border-color: #f0c040;
        }
        .form-group textarea { resize: vertical; min-height: 80px; line-height: 1.6; }
        .form-row {
            display: grid; grid-template-columns: 1fr 1fr; gap: 16px;
        }
        .form-row-3 {
            display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px;
        }

        /* ===== ENTRY CARDS (for experience/education/skills) ===== */
        .entry-card {
            background: rgba(15,15,23,.6); border: 1px solid rgba(240,192,64,.06);
            border-radius: 12px; padding: 20px; margin-bottom: 16px;
            position: relative;
        }
        .entry-card .entry-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 16px;
        }
        .entry-card .entry-header h4 { font-size: .95rem; color: #ddd; }
        .entry-card .entry-actions { display: flex; gap: 8px; }
        .entry-card .entry-actions button {
            width: 32px; height: 32px; border-radius: 8px; border: none;
            cursor: pointer; display: flex; align-items: center; justify-content: center;
            font-size: .8rem; transition: all .2s;
        }
        .btn-move { background: rgba(240,192,64,.1); color: #f0c040; }
        .btn-move:hover { background: rgba(240,192,64,.2); }
        .btn-delete { background: rgba(224,96,64,.1); color: #e06040; }
        .btn-delete:hover { background: rgba(224,96,64,.2); }
        .add-entry-btn {
            width: 100%; padding: 14px; border: 2px dashed rgba(240,192,64,.2);
            background: transparent; color: #f0c040; border-radius: 12px;
            cursor: pointer; font-size: .88rem; font-weight: 500;
            transition: all .2s; display: flex; align-items: center;
            justify-content: center; gap: 8px;
        }
        .add-entry-btn:hover { background: rgba(240,192,64,.05); border-color: #f0c040; }

        /* ===== TOAST ===== */
        .toast {
            position: fixed; bottom: 30px; right: 30px;
            background: #1a1a2e; border: 1px solid rgba(240,192,64,.2);
            border-radius: 12px; padding: 16px 24px;
            display: flex; align-items: center; gap: 10px;
            font-size: .9rem; z-index: 10001;
            transform: translateY(100px); opacity: 0;
            transition: all .4s cubic-bezier(.25,.46,.45,.94);
        }
        .toast.show { transform: translateY(0); opacity: 1; }
        .toast.success { border-color: #40c040; }
        .toast.success i { color: #40c040; }
        .toast.error { border-color: #e06040; }
        .toast.error i { color: #e06040; }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .sidebar { width: 60px; }
            .sidebar-header h3, .sidebar-header p, .sidebar-nav li a span,
            .sidebar-footer .logout-btn span { display: none; }
            .sidebar-nav li a { justify-content: center; padding: 14px; border-left: none; }
            .main-content { margin-left: 60px; padding: 20px; }
            .form-row, .form-row-3 { grid-template-columns: 1fr; }
            .topbar h1 { font-size: 1.2rem; }
        }

        /* ===== SCROLLBAR ===== */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #0f0f17; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }

        /* ===== STATUS BADGE ===== */
        .status-badge {
            display: inline-flex; align-items: center; gap: 6px;
            padding: 4px 12px; border-radius: 20px; font-size: .75rem; font-weight: 600;
        }
        .status-badge.saved { background: rgba(64,192,64,.1); color: #40c040; }
        .status-badge.unsaved { background: rgba(240,192,64,.1); color: #f0c040; }
        .status-badge::before {
            content: ''; width: 6px; height: 6px; border-radius: 50%;
            background: currentColor;
        }

        /* ===== DASHBOARD CARDS ===== */
        .dash-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px;
            margin-bottom: 32px;
        }
        .dash-card {
            background: #1a1a2e; border: 1px solid rgba(240,192,64,.08);
            border-radius: 14px; padding: 24px;
        }
        .dash-card .dash-icon {
            width: 44px; height: 44px; border-radius: 10px;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.1rem; margin-bottom: 14px;
        }
        .dash-card .dash-icon.gold { background: rgba(240,192,64,.1); color: #f0c040; }
        .dash-card .dash-icon.blue { background: rgba(64,160,240,.1); color: #40a0f0; }
        .dash-card .dash-icon.green { background: rgba(64,192,64,.1); color: #40c040; }
        .dash-card .dash-icon.orange { background: rgba(224,96,64,.1); color: #e06040; }
        .dash-card h4 { font-size: 1.8rem; font-weight: 700; margin-bottom: 4px; }
        .dash-card p { font-size: .8rem; color: #888; }
        .quick-links {
            background: #1a1a2e; border: 1px solid rgba(240,192,64,.08);
            border-radius: 14px; padding: 24px;
        }
        .quick-links h3 { font-size: 1rem; margin-bottom: 16px; color: #f0c040; }
        .quick-links a {
            display: flex; align-items: center; gap: 10px;
            padding: 10px 14px; border-radius: 8px; color: #aaa;
            text-decoration: none; font-size: .88rem; transition: all .2s;
        }
        .quick-links a:hover { background: rgba(240,192,64,.05); color: #f0c040; }
        .quick-links a i { width: 18px; text-align: center; }
    </style>
</head>
<body>

<!-- ===== LOGIN ===== -->
<div class="login-screen" id="loginScreen">
    <div class="login-box">
        <div class="logo"><i class="fas fa-shield-halved"></i></div>
        <h2>Admin Panel</h2>
        <p class="sub">Raju Maurya Portfolio Manager</p>
        <input type="password" id="loginPassword" placeholder="Enter admin password" onkeydown="if(event.key==='Enter')attemptLogin()">
        <button class="login-btn" onclick="attemptLogin()"><i class="fas fa-right-to-bracket"></i> Login</button>
        <p class="login-error" id="loginError">Incorrect password. Try again.</p>
    </div>
</div>

<!-- ===== ADMIN WRAPPER ===== -->
<div class="admin-wrapper" id="adminWrapper">

    <!-- SIDEBAR -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h3><i class="fas fa-cog"></i> Portfolio Admin</h3>
            <p>Manage your content</p>
        </div>
        <ul class="sidebar-nav" id="sidebarNav">
            <li><a href="#" class="active" data-panel="dashboard"><i class="fas fa-th-large"></i> <span>Dashboard</span></a></li>
            <li><a href="#" data-panel="hero"><i class="fas fa-star"></i> <span>Hero Section</span></a></li>
            <li><a href="#" data-panel="about"><i class="fas fa-user"></i> <span>About</span></a></li>
            <li><a href="#" data-panel="skills"><i class="fas fa-tools"></i> <span>Skills</span></a></li>
            <li><a href="#" data-panel="experience"><i class="fas fa-briefcase"></i> <span>Experience</span></a></li>
            <li><a href="#" data-panel="education"><i class="fas fa-graduation-cap"></i> <span>Education</span></a></li>
            <li><a href="#" data-panel="contact"><i class="fas fa-address-book"></i> <span>Contact</span></a></li>
            <li><a href="#" data-panel="blog"><i class="fas fa-blog"></i> <span>Blog</span></a></li>
            <li><a href="#" data-panel="settings"><i class="fas fa-sliders"></i> <span>Settings</span></a></li>
        </ul>
        <div class="sidebar-footer">
            <button class="logout-btn" onclick="logout()"><i class="fas fa-sign-out-alt"></i> <span>Logout</span></button>
        </div>
    </aside>

    <!-- MAIN -->
    <main class="main-content">
        <!-- TOP BAR -->
        <div class="topbar">
            <div>
                <h1 id="panelTitle">Dashboard</h1>
                <span class="status-badge saved" id="statusBadge">All changes saved</span>
            </div>
            <div class="topbar-actions">
                <button class="btn btn-reset" onclick="resetAll()"><i class="fas fa-undo"></i> Reset All</button>
                <a href="index.html" target="_blank" class="btn btn-preview"><i class="fas fa-external-link-alt"></i> Preview</a>
                <button class="btn btn-save" onclick="saveAll()"><i class="fas fa-save"></i> Save Changes</button>
            </div>
        </div>

        <!-- ===== DASHBOARD PANEL ===== -->
        <div class="panel active" id="panel-dashboard">
            <div class="dash-grid">
                <div class="dash-card">
                    <div class="dash-icon gold"><i class="fas fa-star"></i></div>
                    <h4 id="dashSkills">6</h4>
                    <p>Skills Listed</p>
                </div>
                <div class="dash-card">
                    <div class="dash-icon blue"><i class="fas fa-briefcase"></i></div>
                    <h4 id="dashExp">8</h4>
                    <p>Experiences</p>
                </div>
                <div class="dash-card">
                    <div class="dash-icon green"><i class="fas fa-graduation-cap"></i></div>
                    <h4 id="dashEdu">5</h4>
                    <p>Education Entries</p>
                </div>
                <div class="dash-card">
                    <div class="dash-icon orange"><i class="fas fa-file-alt"></i></div>
                    <h4>18</h4>
                    <p>Documents</p>
                </div>
                <div class="dash-card">
                    <div class="dash-icon" style="background:rgba(160,64,240,.1);color:#a040f0;"><i class="fas fa-blog"></i></div>
                    <h4 id="dashBlog">0</h4>
                    <p>Blog Posts</p>
                </div>
            </div>
            <div class="quick-links">
                <h3><i class="fas fa-bolt"></i> Quick Actions</h3>
                <a href="#" onclick="switchPanel('hero')"><i class="fas fa-pen"></i> Edit Hero Section</a>
                <a href="#" onclick="switchPanel('about')"><i class="fas fa-user-edit"></i> Edit About Section</a>
                <a href="#" onclick="switchPanel('skills')"><i class="fas fa-plus"></i> Add / Edit Skills</a>
                <a href="#" onclick="switchPanel('experience')"><i class="fas fa-briefcase"></i> Edit Experience</a>
                <a href="#" onclick="switchPanel('education')"><i class="fas fa-graduation-cap"></i> Edit Education</a>
                <a href="#" onclick="switchPanel('contact')"><i class="fas fa-address-book"></i> Edit Contact Info</a>
                <a href="#" onclick="switchPanel('blog')"><i class="fas fa-blog"></i> Manage Blog</a>
                <a href="blog.html" target="_blank"><i class="fas fa-rss"></i> View Blog</a>
                <a href="index.html" target="_blank"><i class="fas fa-external-link-alt"></i> View Live Portfolio</a>
            </div>
        </div>

        <!-- ===== HERO PANEL ===== -->
        <div class="panel" id="panel-hero">
            <div class="form-section">
                <h3><i class="fas fa-star"></i> Hero Section</h3>
                <div class="form-group">
                    <label>Greeting Text</label>
                    <input type="text" id="heroGreeting" placeholder="e.g. Hello, I'm">
                </div>
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" id="heroName" placeholder="e.g. Raju Maurya">
                </div>
                <div class="form-group">
                    <label>Tagline</label>
                    <textarea id="heroTagline" rows="2" placeholder="Your professional tagline..."></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Primary Button Text</label>
                        <input type="text" id="heroBtnPrimary" placeholder="e.g. Explore My Work">
                    </div>
                    <div class="form-group">
                        <label>Secondary Button Text</label>
                        <input type="text" id="heroBtnSecondary" placeholder="e.g. Get In Touch">
                    </div>
                </div>
            </div>
        </div>

        <!-- ===== ABOUT PANEL ===== -->
        <div class="panel" id="panel-about">
            <div class="form-section">
                <h3><i class="fas fa-user"></i> About Section</h3>
                <div class="form-group">
                    <label>Story Box Narration</label>
                    <textarea id="aboutStory" rows="3" placeholder="The introductory story narration..."></textarea>
                </div>
                <div class="form-group">
                    <label>About Name</label>
                    <input type="text" id="aboutName" placeholder="e.g. Raju Maurya">
                </div>
                <div class="form-group">
                    <label>Paragraph 1 (supports HTML)</label>
                    <textarea id="aboutP1" rows="3" placeholder="First about paragraph..."></textarea>
                </div>
                <div class="form-group">
                    <label>Paragraph 2 (supports HTML)</label>
                    <textarea id="aboutP2" rows="3" placeholder="Second about paragraph..."></textarea>
                </div>
                <div class="form-group">
                    <label>Paragraph 3 (supports HTML)</label>
                    <textarea id="aboutP3" rows="3" placeholder="Third about paragraph..."></textarea>
                </div>
            </div>
            <div class="form-section">
                <h3><i class="fas fa-chart-bar"></i> Stats Counters</h3>
                <div class="form-row-3">
                    <div class="form-group">
                        <label>Stat 1 Number</label>
                        <input type="number" id="stat1Num" placeholder="8">
                    </div>
                    <div class="form-group">
                        <label>Stat 1 Label</label>
                        <input type="text" id="stat1Label" placeholder="Work Experiences">
                    </div>
                    <div class="form-group">
                        <label>&nbsp;</label>
                    </div>
                    <div class="form-group">
                        <label>Stat 2 Number</label>
                        <input type="number" id="stat2Num" placeholder="10">
                    </div>
                    <div class="form-group">
                        <label>Stat 2 Label</label>
                        <input type="text" id="stat2Label" placeholder="Certificates">
                    </div>
                    <div class="form-group">
                        <label>&nbsp;</label>
                    </div>
                    <div class="form-group">
                        <label>Stat 3 Number</label>
                        <input type="number" id="stat3Num" placeholder="5">
                    </div>
                    <div class="form-group">
                        <label>Stat 3 Label</label>
                        <input type="text" id="stat3Label" placeholder="Education Milestones">
                    </div>
                </div>
            </div>
        </div>

        <!-- ===== SKILLS PANEL ===== -->
        <div class="panel" id="panel-skills">
            <div class="form-section">
                <h3><i class="fas fa-tools"></i> Skills</h3>
                <div id="skillsContainer"></div>
                <button class="add-entry-btn" onclick="addSkill()"><i class="fas fa-plus"></i> Add New Skill</button>
            </div>
        </div>

        <!-- ===== EXPERIENCE PANEL ===== -->
        <div class="panel" id="panel-experience">
            <div class="form-section">
                <h3><i class="fas fa-briefcase"></i> Work Experience</h3>
                <div id="expContainer"></div>
                <button class="add-entry-btn" onclick="addExperience()"><i class="fas fa-plus"></i> Add New Experience</button>
            </div>
        </div>

        <!-- ===== EDUCATION PANEL ===== -->
        <div class="panel" id="panel-education">
            <div class="form-section">
                <h3><i class="fas fa-graduation-cap"></i> Education</h3>
                <div id="eduContainer"></div>
                <button class="add-entry-btn" onclick="addEducation()"><i class="fas fa-plus"></i> Add New Education</button>
            </div>
        </div>

        <!-- ===== BLOG PANEL ===== -->
        <div class="panel" id="panel-blog">
            <div class="form-section">
                <h3><i class="fas fa-blog"></i> Blog Posts</h3>
                <p style="color:#888;font-size:.85rem;margin-bottom:20px;">Create and manage blog posts. Published posts will appear on the <a href="blog.html" target="_blank" style="color:#f0c040;">Blog page</a>.</p>
                <div id="blogContainer"></div>
                <button class="add-entry-btn" onclick="addBlogPost()"><i class="fas fa-plus"></i> Add New Blog Post</button>
            </div>
        </div>

        <!-- ===== BLOG EDITOR PANEL ===== -->
        <div class="panel" id="panel-blog-editor">
            <div class="form-section">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
                    <h3><i class="fas fa-pen-to-square"></i> <span id="blogEditorTitle">Edit Blog Post</span></h3>
                    <button class="btn btn-preview" onclick="switchPanel('blog')" style="padding:8px 18px;"><i class="fas fa-arrow-left"></i> Back to List</button>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Post Title *</label>
                        <input type="text" id="blogTitle" placeholder="Enter blog post title...">
                    </div>
                    <div class="form-group">
                        <label>Category</label>
                        <input type="text" id="blogCategory" placeholder="e.g. SEO, Marketing, Career">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Date</label>
                        <input type="date" id="blogDate">
                    </div>
                    <div class="form-group">
                        <label>Cover Image URL (optional)</label>
                        <input type="text" id="blogCover" placeholder="https://...">
                    </div>
                </div>
                <div class="form-group">
                    <label>Content (supports HTML — use &lt;h2&gt;, &lt;p&gt;, &lt;ul&gt;, &lt;blockquote&gt; etc.)</label>
                    <textarea id="blogContent" rows="16" placeholder="Write your blog post content here...
Use HTML tags for formatting:

<h2>Section Title</h2>
<p>Your paragraph text here...</p>
<ul><li>Bullet point</li></ul>
<blockquote>A quote</blockquote>

Or just write plain text — paragraphs separated by blank lines will be auto-formatted."></textarea>
                </div>
                <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
                    <label style="display:flex;align-items:center;gap:8px;cursor:pointer;color:#aaa;font-size:.9rem;">
                        <input type="checkbox" id="blogPublished" style="accent-color:#f0c040;width:18px;height:18px;">
                        Published (visible on blog)
                    </label>
                </div>
                <div style="display:flex;gap:12px;margin-top:20px;">
                    <button class="btn btn-save" onclick="saveBlogPost()" style="padding:12px 28px;"><i class="fas fa-save"></i> Save Post</button>
                    <button class="btn btn-preview" onclick="previewBlogPost()" style="padding:12px 28px;"><i class="fas fa-eye"></i> Preview</button>
                    <button class="btn btn-reset" onclick="switchPanel('blog')" style="padding:12px 28px;"><i class="fas fa-times"></i> Cancel</button>
                </div>
            </div>
        </div>

        <!-- ===== CONTACT PANEL ===== -->
        <div class="panel" id="panel-contact">
            <div class="form-section">
                <h3><i class="fas fa-address-book"></i> Contact Information</h3>
                <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" id="contactEmail" placeholder="email@example.com">
                </div>
                <div class="form-group">
                    <label>Phone Number</label>
                    <input type="text" id="contactPhone" placeholder="+91 8988353656">
                </div>
                <div class="form-group">
                    <label>LinkedIn URL</label>
                    <input type="url" id="contactLinkedin" placeholder="https://linkedin.com/in/...">
                </div>
            </div>
            <div class="form-section">
                <h3><i class="fas fa-comment-dots"></i> Contact Story Box</h3>
                <div class="form-group">
                    <label>Contact Section Narration</label>
                    <textarea id="contactStory" rows="3" placeholder="The story narration for the contact section..."></textarea>
                </div>
            </div>
        </div>

        <!-- ===== SETTINGS PANEL ===== -->
        <div class="panel" id="panel-settings">
            <div class="form-section">
                <h3><i class="fas fa-key"></i> Change Admin Password</h3>
                <div class="form-group">
                    <label>Current Password</label>
                    <input type="password" id="currentPwd" placeholder="Enter current password">
                </div>
                <div class="form-group">
                    <label>New Password</label>
                    <input type="password" id="newPwd" placeholder="Enter new password">
                </div>
                <div class="form-group">
                    <label>Confirm New Password</label>
                    <input type="password" id="confirmPwd" placeholder="Confirm new password">
                </div>
                <button class="btn btn-save" onclick="changePassword()" style="margin-top:8px;"><i class="fas fa-key"></i> Update Password</button>
            </div>
            <div class="form-section">
                <h3><i class="fas fa-database"></i> Data Management</h3>
                <div style="display:flex; gap:12px; flex-wrap:wrap;">
                    <button class="btn btn-preview" onclick="exportData()"><i class="fas fa-download"></i> Export Data (JSON)</button>
                    <label class="btn btn-preview" style="cursor:pointer;">
                        <i class="fas fa-upload"></i> Import Data (JSON)
                        <input type="file" accept=".json" onchange="importData(event)" style="display:none;">
                    </label>
                    <button class="btn btn-reset" onclick="resetAll()"><i class="fas fa-trash"></i> Reset Everything</button>
                </div>
            </div>
        </div>

    </main>
</div>

<!-- TOAST -->
<div class="toast" id="toast"><i class="fas fa-check-circle"></i> <span id="toastMsg">Saved!</span></div>

<script>
// ============================================================
// DEFAULT DATA — mirrors the current portfolio content
// ============================================================
const DEFAULT_DATA = {
    hero: {
        greeting: "Hello, I'm",
        name: "Raju Maurya",
        tagline: "BBA Final Year Student | Digital Marketing Executive at Marcom | SEO, Project & Event Management | Aspiring Entrepreneur & Strategic Business Developer",
        btnPrimary: "Explore My Work",
        btnSecondary: "Get In Touch"
    },
    about: {
        story: "Every great story starts with a spark of curiosity. Mine began with a fascination for how digital channels can transform brands and create real impact. From spreadsheets to search engines, I discovered my calling at the intersection of data, strategy, and creativity.",
        name: "Raju Maurya",
        p1: 'BBA Final Year Student at <span class="highlight">Sanskriti University</span> specializing in Operations Management, Business Administration &amp; Digital Marketing. Currently working as a <span class="highlight">Digital Marketing Executive at Marcom</span>.',
        p2: 'My journey spans from <span class="highlight">Content Creator &amp; Page Manager</span> at UnlockGrowthMedia, to <span class="highlight">Team Lead</span> at UnlockDiscounts, to <span class="highlight">Sales &amp; Marketing Intern</span> at CTPL. Certified by <span class="highlight">PMI, Coursera, Oxford &amp; Simplilearn</span>.',
        p3: '<em>"Not in a day, but one day, I\'ll make myself bigger and better."</em> — I believe in the power of <span class="highlight">data-driven storytelling</span>, turning numbers into narratives that guide smarter decisions.',
        stat1Num: 8, stat1Label: "Work Experiences",
        stat2Num: 10, stat2Label: "Certificates",
        stat3Num: 5, stat3Label: "Education Milestones"
    },
    skills: [
        { icon: "fas fa-chart-line", title: "Digital Marketing", desc: "Crafting comprehensive digital strategies that drive engagement, conversions, and brand visibility across platforms.", level: 90 },
        { icon: "fas fa-search", title: "SEO", desc: "On-page & off-page optimization, keyword research, and technical SEO to boost organic traffic and rankings.", level: 85 },
        { icon: "fas fa-chart-bar", title: "Google Analytics", desc: "Deep expertise in GA tracking, audience insights, conversion funnels, and data-driven reporting.", level: 88 },
        { icon: "fas fa-tasks", title: "Project Management", desc: "End-to-end project planning, execution, and delivery using agile and traditional methodologies.", level: 92 },
        { icon: "fas fa-file-excel", title: "Microsoft Excel", desc: "Advanced formulas, pivot tables, VLOOKUP, data visualization, and macro-level analysis.", level: 87 },
        { icon: "fas fa-bullhorn", title: "Brand Strategy", desc: "Building cohesive brand narratives and market positioning through research-backed creative campaigns.", level: 80 }
    ],
    experience: [
        { date: "Jan 2026 — Present", title: "Digital Marketing Executive", company: "Marcom", location: "Mathura", desc: "SEO content writing and optimization\nSocial bookmarking and backlink building\nMonthly SEO performance reporting\nWebsite research and competitor analysis\nTechnical and on-page SEO audits\nMeta tags and keyword optimization\nGoogle Analytics traffic analysis\nOrganic search growth strategies" },
        { date: "Sep 2025 — Present", title: "Content Creator & Page Manager", company: "UnlockGrowthMedia", location: "Gorakhpur, Uttar Pradesh", desc: "Delivered resume writing and content writing services focused on clarity, structure, and readability\nConducted basic website audits to identify content, SEO, and usability improvements\nManaged content uploads and assisted with improving online visibility" },
        { date: "Sep 2025", title: "Content Researcher Team Lead", company: "UnlockDiscounts", location: "Bengaluru, Karnataka", desc: "Led and trained a team to research trending content for digital platforms\nEnsured quality assurance standards across all content\nConducted training sessions for team skill development" },
        { date: "Apr 2025 — Sep 2025", title: "Digital Marketing Intern", company: "UnlockDiscounts", location: "Bengaluru, Karnataka", desc: "Writing and publishing SEO-optimized website blogs\nConducting product analysis and market research\nPracticing on-page and off-page SEO techniques\nDesigning creative posters for marketing campaigns\nSupporting brand acceleration and digital branding initiatives\nAssisting the video editing team with motivational content timestamps" },
        { date: "Jun 2025 — Aug 2025", title: "Sales Operations & Marketing Intern", company: "CTPL — Creanovation Technologies Pvt. Ltd.", location: "Gurugram, Haryana", desc: "CRM Cold calling & Course Selling\nBrand Promotion & Awareness campaigns\nDocumentation, reporting & student onboarding\nSales strategy development and execution" },
        { date: "Oct 2024 — Dec 2025", title: "Member of Student Council & Entrepreneurial Club", company: "Sanskriti University", location: "Mathura, Uttar Pradesh", desc: "Served as Marketing Secretary in the Student Council and active member of the Entrepreneurial Club, developing leadership and organizational skills." },
        { date: "Apr 2024 — Aug 2024", title: "Administrative Intern", company: "Sanskriti University", location: "Mathura, Uttar Pradesh", desc: "Handled student and parent inquiries, supporting lead nurturing and conversion\nCoordinated follow-ups, documentation, and admission processes\nSupported admission-related events and enrollment activities\nGained exposure to academic administration and CRM coordination" },
        { date: "Apr 2023 — Jul 2023", title: "Student Tutor", company: "JOBS Computer Institute", location: "Gorakhpur & Maharajganj", desc: "Taught computer fundamentals and supervised practical sessions\nPrepared study materials tailored to student needs\nEvaluated student performance through regular assessments\nProvided personalized support to improve technical skills" }
    ],
    education: [
        { date: "Aug 2023 — Oct 2026", title: "Bachelor of Business Administration (BBA)", institution: "Sanskriti University", location: "Mathura, Uttar Pradesh", desc: "Specialization in Business Administration, Management and Operations. Currently in final year — building skills in SEO, Project & Event Management, and strategic business development." },
        { date: "Jan 2024 — Feb 2024", title: "Project Management Studies", institution: "Project Management Institute (PMI)", location: "", desc: "Completed professional project management certification covering planning, execution, and delivery methodologies." },
        { date: "Jan 2024", title: "Introduction to Microsoft Excel", institution: "Coursera", location: "", desc: "Mastered advanced Excel functions including formulas, pivot tables, VLOOKUP, and data visualization techniques." },
        { date: "Apr 2021 — Mar 2022", title: "Intermediate (12th)", institution: "GSSS Barsar, Hamirpur, Himachal Pradesh", location: "", desc: "Completed intermediate education with focus on building a strong academic foundation." },
        { date: "Apr 2019 — Mar 2020", title: "High School (10th)", institution: "GSSS Barsar, Hamirpur, Himachal Pradesh", location: "", desc: "Completed high school education — the foundation of the academic journey." }
    ],
    contact: {
        email: "mauryaraju556@gmail.com",
        phone: "+91 8988353656",
        linkedin: "https://www.linkedin.com/in/raju-maurya-68488a297",
        story: "The best stories are collaborative. If you're looking for someone who brings strategy, creativity, and data-driven thinking to the table — let's talk. I'm always open to exciting opportunities and meaningful connections."
    }
};

// ============================================================
// STATE
// ============================================================
const STORAGE_KEY = 'raju_portfolio_data';
const PWD_KEY = 'raju_admin_pwd';
const DEFAULT_PWD = 'admin123';
let data = {};

function loadData() {
    const saved = localStorage.getItem(STORAGE_KEY);
    if (saved) {
        try { data = JSON.parse(saved); } catch { data = JSON.parse(JSON.stringify(DEFAULT_DATA)); }
    } else {
        data = JSON.parse(JSON.stringify(DEFAULT_DATA));
    }
}

function getPassword() {
    return localStorage.getItem(PWD_KEY) || DEFAULT_PWD;
}

// ============================================================
// LOGIN
// ============================================================
function attemptLogin() {
    const pwd = document.getElementById('loginPassword').value;
    if (pwd === getPassword()) {
        document.getElementById('loginScreen').classList.add('hidden');
        document.getElementById('adminWrapper').classList.add('show');
        sessionStorage.setItem('admin_logged_in', '1');
    } else {
        document.getElementById('loginError').classList.add('show');
        document.getElementById('loginPassword').value = '';
        setTimeout(() => document.getElementById('loginError').classList.remove('show'), 2500);
    }
}

function logout() {
    sessionStorage.removeItem('admin_logged_in');
    document.getElementById('loginScreen').classList.remove('hidden');
    document.getElementById('adminWrapper').classList.remove('show');
    document.getElementById('loginPassword').value = '';
}

function checkSession() {
    if (sessionStorage.getItem('admin_logged_in') === '1') {
        document.getElementById('loginScreen').classList.add('hidden');
        document.getElementById('adminWrapper').classList.add('show');
    }
}

// ============================================================
// PANEL NAVIGATION
// ============================================================
function switchPanel(name) {
    document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
    const panel = document.getElementById('panel-' + name);
    if (panel) panel.classList.add('active');
    document.querySelectorAll('.sidebar-nav a').forEach(a => {
        a.classList.toggle('active', a.dataset.panel === name);
    });
    const titles = {
        dashboard: 'Dashboard', hero: 'Hero Section', about: 'About Section',
        skills: 'Skills', experience: 'Experience', education: 'Education',
        contact: 'Contact Info', blog: 'Blog Posts', 'blog-editor': 'Blog Editor', settings: 'Settings'
    };
    document.getElementById('panelTitle').textContent = titles[name] || 'Dashboard';
}

// ============================================================
// POPULATE FORMS FROM DATA
// ============================================================
function populateForms() {
    // Hero
    document.getElementById('heroGreeting').value = data.hero.greeting || '';
    document.getElementById('heroName').value = data.hero.name || '';
    document.getElementById('heroTagline').value = data.hero.tagline || '';
    document.getElementById('heroBtnPrimary').value = data.hero.btnPrimary || '';
    document.getElementById('heroBtnSecondary').value = data.hero.btnSecondary || '';

    // About
    document.getElementById('aboutStory').value = data.about.story || '';
    document.getElementById('aboutName').value = data.about.name || '';
    document.getElementById('aboutP1').value = data.about.p1 || '';
    document.getElementById('aboutP2').value = data.about.p2 || '';
    document.getElementById('aboutP3').value = data.about.p3 || '';
    document.getElementById('stat1Num').value = data.about.stat1Num || 0;
    document.getElementById('stat1Label').value = data.about.stat1Label || '';
    document.getElementById('stat2Num').value = data.about.stat2Num || 0;
    document.getElementById('stat2Label').value = data.about.stat2Label || '';
    document.getElementById('stat3Num').value = data.about.stat3Num || 0;
    document.getElementById('stat3Label').value = data.about.stat3Label || '';

    // Contact
    document.getElementById('contactEmail').value = data.contact.email || '';
    document.getElementById('contactPhone').value = data.contact.phone || '';
    document.getElementById('contactLinkedin').value = data.contact.linkedin || '';
    document.getElementById('contactStory').value = data.contact.story || '';

    // Skills
    renderSkills();
    // Experience
    renderExperience();
    // Education
    renderEducation();
    // Dashboard counts
    updateDashboard();
}

// ============================================================
// SKILLS CRUD
// ============================================================
function renderSkills() {
    const container = document.getElementById('skillsContainer');
    container.innerHTML = '';
    data.skills.forEach((skill, i) => {
        container.innerHTML += `
        <div class="entry-card" data-index="${i}">
            <div class="entry-header">
                <h4><i class="${skill.icon}"></i> ${skill.title || 'New Skill'}</h4>
                <div class="entry-actions">
                    ${i > 0 ? `<button class="btn-move" onclick="moveSkill(${i},-1)" title="Move Up"><i class="fas fa-arrow-up"></i></button>` : ''}
                    ${i < data.skills.length-1 ? `<button class="btn-move" onclick="moveSkill(${i},1)" title="Move Down"><i class="fas fa-arrow-down"></i></button>` : ''}
                    <button class="btn-delete" onclick="deleteSkill(${i})" title="Delete"><i class="fas fa-trash"></i></button>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group"><label>Icon Class (Font Awesome)</label><input type="text" value="${skill.icon}" onchange="data.skills[${i}].icon=this.value;markUnsaved()"></div>
                <div class="form-group"><label>Skill Title</label><input type="text" value="${escHtml(skill.title)}" onchange="data.skills[${i}].title=this.value;markUnsaved()"></div>
            </div>
            <div class="form-group"><label>Description</label><textarea rows="2" onchange="data.skills[${i}].desc=this.value;markUnsaved()">${escHtml(skill.desc)}</textarea></div>
            <div class="form-group"><label>Skill Level (%) — ${skill.level}%</label><input type="range" min="0" max="100" value="${skill.level}" style="width:100%;accent-color:#f0c040;" oninput="data.skills[${i}].level=+this.value;this.previousElementSibling&&(this.parentElement.querySelector('label').textContent='Skill Level (%) — '+this.value+'%');markUnsaved()"></div>
        </div>`;
    });
}

function addSkill() {
    data.skills.push({ icon: 'fas fa-star', title: 'New Skill', desc: 'Describe this skill...', level: 75 });
    renderSkills(); markUnsaved();
}
function deleteSkill(i) { data.skills.splice(i, 1); renderSkills(); markUnsaved(); }
function moveSkill(i, dir) {
    const j = i + dir;
    [data.skills[i], data.skills[j]] = [data.skills[j], data.skills[i]];
    renderSkills(); markUnsaved();
}

// ============================================================
// EXPERIENCE CRUD
// ============================================================
function renderExperience() {
    const container = document.getElementById('expContainer');
    container.innerHTML = '';
    data.experience.forEach((exp, i) => {
        container.innerHTML += `
        <div class="entry-card">
            <div class="entry-header">
                <h4>${escHtml(exp.title) || 'New Experience'}</h4>
                <div class="entry-actions">
                    ${i > 0 ? `<button class="btn-move" onclick="moveExp(${i},-1)"><i class="fas fa-arrow-up"></i></button>` : ''}
                    ${i < data.experience.length-1 ? `<button class="btn-move" onclick="moveExp(${i},1)"><i class="fas fa-arrow-down"></i></button>` : ''}
                    <button class="btn-delete" onclick="deleteExp(${i})"><i class="fas fa-trash"></i></button>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group"><label>Date / Period</label><input type="text" value="${escHtml(exp.date)}" onchange="data.experience[${i}].date=this.value;markUnsaved()"></div>
                <div class="form-group"><label>Job Title</label><input type="text" value="${escHtml(exp.title)}" onchange="data.experience[${i}].title=this.value;markUnsaved()"></div>
            </div>
            <div class="form-row">
                <div class="form-group"><label>Company</label><input type="text" value="${escHtml(exp.company)}" onchange="data.experience[${i}].company=this.value;markUnsaved()"></div>
                <div class="form-group"><label>Location</label><input type="text" value="${escHtml(exp.location)}" onchange="data.experience[${i}].location=this.value;markUnsaved()"></div>
            </div>
            <div class="form-group"><label>Description (one bullet per line)</label><textarea rows="4" onchange="data.experience[${i}].desc=this.value;markUnsaved()">${escHtml(exp.desc)}</textarea></div>
        </div>`;
    });
}
function addExperience() {
    data.experience.unshift({ date: 'Date', title: 'New Position', company: 'Company', location: 'Location', desc: '' });
    renderExperience(); markUnsaved();
}
function deleteExp(i) { data.experience.splice(i, 1); renderExperience(); markUnsaved(); }
function moveExp(i, dir) {
    const j = i + dir;
    [data.experience[i], data.experience[j]] = [data.experience[j], data.experience[i]];
    renderExperience(); markUnsaved();
}

// ============================================================
// EDUCATION CRUD
// ============================================================
function renderEducation() {
    const container = document.getElementById('eduContainer');
    container.innerHTML = '';
    data.education.forEach((edu, i) => {
        container.innerHTML += `
        <div class="entry-card">
            <div class="entry-header">
                <h4>${escHtml(edu.title) || 'New Education'}</h4>
                <div class="entry-actions">
                    ${i > 0 ? `<button class="btn-move" onclick="moveEdu(${i},-1)"><i class="fas fa-arrow-up"></i></button>` : ''}
                    ${i < data.education.length-1 ? `<button class="btn-move" onclick="moveEdu(${i},1)"><i class="fas fa-arrow-down"></i></button>` : ''}
                    <button class="btn-delete" onclick="deleteEdu(${i})"><i class="fas fa-trash"></i></button>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group"><label>Date / Period</label><input type="text" value="${escHtml(edu.date)}" onchange="data.education[${i}].date=this.value;markUnsaved()"></div>
                <div class="form-group"><label>Degree / Course Title</label><input type="text" value="${escHtml(edu.title)}" onchange="data.education[${i}].title=this.value;markUnsaved()"></div>
            </div>
            <div class="form-row">
                <div class="form-group"><label>Institution</label><input type="text" value="${escHtml(edu.institution)}" onchange="data.education[${i}].institution=this.value;markUnsaved()"></div>
                <div class="form-group"><label>Location (optional)</label><input type="text" value="${escHtml(edu.location || '')}" onchange="data.education[${i}].location=this.value;markUnsaved()"></div>
            </div>
            <div class="form-group"><label>Description</label><textarea rows="2" onchange="data.education[${i}].desc=this.value;markUnsaved()">${escHtml(edu.desc)}</textarea></div>
        </div>`;
    });
}
function addEducation() {
    data.education.unshift({ date: 'Date', title: 'New Degree', institution: 'Institution', location: '', desc: '' });
    renderEducation(); markUnsaved();
}
function deleteEdu(i) { data.education.splice(i, 1); renderEducation(); markUnsaved(); }
function moveEdu(i, dir) {
    const j = i + dir;
    [data.education[i], data.education[j]] = [data.education[j], data.education[i]];
    renderEducation(); markUnsaved();
}

// ============================================================
// COLLECT FORM DATA BACK INTO STATE
// ============================================================
function collectFromForms() {
    data.hero.greeting = document.getElementById('heroGreeting').value;
    data.hero.name = document.getElementById('heroName').value;
    data.hero.tagline = document.getElementById('heroTagline').value;
    data.hero.btnPrimary = document.getElementById('heroBtnPrimary').value;
    data.hero.btnSecondary = document.getElementById('heroBtnSecondary').value;

    data.about.story = document.getElementById('aboutStory').value;
    data.about.name = document.getElementById('aboutName').value;
    data.about.p1 = document.getElementById('aboutP1').value;
    data.about.p2 = document.getElementById('aboutP2').value;
    data.about.p3 = document.getElementById('aboutP3').value;
    data.about.stat1Num = +document.getElementById('stat1Num').value;
    data.about.stat1Label = document.getElementById('stat1Label').value;
    data.about.stat2Num = +document.getElementById('stat2Num').value;
    data.about.stat2Label = document.getElementById('stat2Label').value;
    data.about.stat3Num = +document.getElementById('stat3Num').value;
    data.about.stat3Label = document.getElementById('stat3Label').value;

    data.contact.email = document.getElementById('contactEmail').value;
    data.contact.phone = document.getElementById('contactPhone').value;
    data.contact.linkedin = document.getElementById('contactLinkedin').value;
    data.contact.story = document.getElementById('contactStory').value;
}

// ============================================================
// SAVE / RESET
// ============================================================
function saveAll() {
    collectFromForms();
    localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
    showToast('All changes saved successfully!', 'success');
    markSaved();
    updateDashboard();
}

function resetAll() {
    if (!confirm('Are you sure? This will reset ALL portfolio data to default values.')) return;
    localStorage.removeItem(STORAGE_KEY);
    data = JSON.parse(JSON.stringify(DEFAULT_DATA));
    populateForms();
    showToast('All data reset to defaults.', 'success');
    markSaved();
}

function changePassword() {
    const current = document.getElementById('currentPwd').value;
    const newP = document.getElementById('newPwd').value;
    const confirm = document.getElementById('confirmPwd').value;
    if (current !== getPassword()) { showToast('Current password is incorrect.', 'error'); return; }
    if (newP.length < 4) { showToast('Password must be at least 4 characters.', 'error'); return; }
    if (newP !== confirm) { showToast('New passwords do not match.', 'error'); return; }
    localStorage.setItem(PWD_KEY, newP);
    document.getElementById('currentPwd').value = '';
    document.getElementById('newPwd').value = '';
    document.getElementById('confirmPwd').value = '';
    showToast('Password updated successfully!', 'success');
}

// ============================================================
// EXPORT / IMPORT
// ============================================================
function exportData() {
    collectFromForms();
    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = 'portfolio_data.json'; a.click();
    URL.revokeObjectURL(url);
    showToast('Data exported!', 'success');
}

function importData(event) {
    const file = event.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = (e) => {
        try {
            const imported = JSON.parse(e.target.result);
            data = imported;
            localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
            populateForms();
            showToast('Data imported successfully!', 'success');
            markSaved();
        } catch {
            showToast('Invalid JSON file.', 'error');
        }
    };
    reader.readAsText(file);
    event.target.value = '';
}

// ============================================================
// UI HELPERS
// ============================================================
function markUnsaved() {
    const badge = document.getElementById('statusBadge');
    badge.textContent = 'Unsaved changes';
    badge.className = 'status-badge unsaved';
}
function markSaved() {
    const badge = document.getElementById('statusBadge');
    badge.textContent = 'All changes saved';
    badge.className = 'status-badge saved';
}

function updateDashboard() {
    document.getElementById('dashSkills').textContent = data.skills.length;
    document.getElementById('dashExp').textContent = data.experience.length;
    document.getElementById('dashEdu').textContent = data.education.length;
    const blogs = loadBlogPosts();
    document.getElementById('dashBlog').textContent = blogs.length;
}

// ============================================================
// BLOG CRUD (separate localStorage key)
// ============================================================
const BLOG_KEY = 'raju_blog_posts';
let editingBlogId = null;

function loadBlogPosts() {
    const raw = localStorage.getItem(BLOG_KEY);
    if (!raw) return [];
    try { return JSON.parse(raw); } catch { return []; }
}

function saveBlogPosts(posts) {
    localStorage.setItem(BLOG_KEY, JSON.stringify(posts));
}

function renderBlogList() {
    const container = document.getElementById('blogContainer');
    const posts = loadBlogPosts();
    container.innerHTML = '';
    if (posts.length === 0) {
        container.innerHTML = '<p style="color:#666;text-align:center;padding:30px;">No blog posts yet. Click "Add New Blog Post" to create one.</p>';
        return;
    }
    posts.forEach((post, i) => {
        const dateStr = post.date ? new Date(post.date).toLocaleDateString('en-US', { year:'numeric', month:'short', day:'numeric' }) : 'No date';
        container.innerHTML += `
        <div class="entry-card">
            <div class="entry-header">
                <h4>
                    <span style="display:inline-block;width:10px;height:10px;border-radius:50%;background:${post.published ? '#40c040' : '#888'};margin-right:8px;"></span>
                    ${escHtml(post.title) || 'Untitled Post'}
                    <span style="color:#666;font-size:.78rem;font-weight:400;margin-left:10px;">${dateStr}</span>
                    ${post.category ? `<span style="background:rgba(240,192,64,.1);color:#f0c040;padding:2px 10px;border-radius:12px;font-size:.72rem;margin-left:8px;">${escHtml(post.category)}</span>` : ''}
                </h4>
                <div class="entry-actions">
                    <button class="btn-move" onclick="editBlogPost('${post.id}')" title="Edit"><i class="fas fa-pen"></i></button>
                    ${post.published ? `<button class="btn-move" onclick="window.open('blog-post.html?id=${post.id}','_blank')" title="View"><i class="fas fa-external-link-alt"></i></button>` : ''}
                    <button class="btn-move" onclick="togglePublishBlog('${post.id}')" title="${post.published ? 'Unpublish' : 'Publish'}"><i class="fas fa-${post.published ? 'eye-slash' : 'eye'}"></i></button>
                    <button class="btn-delete" onclick="deleteBlogPost('${post.id}')" title="Delete"><i class="fas fa-trash"></i></button>
                </div>
            </div>
            <p style="color:#888;font-size:.85rem;margin-top:6px;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;">${escHtml(post.content ? post.content.replace(/<[^>]*>/g,'').substring(0,200) : '')}</p>
        </div>`;
    });
}

function addBlogPost() {
    editingBlogId = null;
    document.getElementById('blogEditorTitle').textContent = 'New Blog Post';
    document.getElementById('blogTitle').value = '';
    document.getElementById('blogCategory').value = '';
    document.getElementById('blogDate').value = new Date().toISOString().split('T')[0];
    document.getElementById('blogCover').value = '';
    document.getElementById('blogContent').value = '';
    document.getElementById('blogPublished').checked = false;
    switchPanel('blog-editor');
}

function editBlogPost(id) {
    const posts = loadBlogPosts();
    const post = posts.find(p => p.id === id);
    if (!post) return;
    editingBlogId = id;
    document.getElementById('blogEditorTitle').textContent = 'Edit Blog Post';
    document.getElementById('blogTitle').value = post.title || '';
    document.getElementById('blogCategory').value = post.category || '';
    document.getElementById('blogDate').value = post.date || '';
    document.getElementById('blogCover').value = post.coverImage || '';
    document.getElementById('blogContent').value = post.content || '';
    document.getElementById('blogPublished').checked = !!post.published;
    switchPanel('blog-editor');
}

function saveBlogPost() {
    const title = document.getElementById('blogTitle').value.trim();
    if (!title) { showToast('Please enter a post title.', 'error'); return; }
    const posts = loadBlogPosts();
    const postData = {
        id: editingBlogId || 'post_' + Date.now(),
        title: title,
        category: document.getElementById('blogCategory').value.trim(),
        date: document.getElementById('blogDate').value,
        coverImage: document.getElementById('blogCover').value.trim(),
        content: document.getElementById('blogContent').value,
        published: document.getElementById('blogPublished').checked,
        updatedAt: new Date().toISOString()
    };
    if (editingBlogId) {
        const idx = posts.findIndex(p => p.id === editingBlogId);
        if (idx !== -1) { posts[idx] = { ...posts[idx], ...postData }; }
    } else {
        postData.createdAt = new Date().toISOString();
        posts.unshift(postData);
    }
    saveBlogPosts(posts);
    renderBlogList();
    updateDashboard();
    showToast('Blog post saved!', 'success');
    switchPanel('blog');
}

function deleteBlogPost(id) {
    if (!confirm('Delete this blog post permanently?')) return;
    let posts = loadBlogPosts();
    posts = posts.filter(p => p.id !== id);
    saveBlogPosts(posts);
    renderBlogList();
    updateDashboard();
    showToast('Blog post deleted.', 'success');
}

function togglePublishBlog(id) {
    const posts = loadBlogPosts();
    const post = posts.find(p => p.id === id);
    if (post) {
        post.published = !post.published;
        saveBlogPosts(posts);
        renderBlogList();
        showToast(post.published ? 'Post published!' : 'Post unpublished.', 'success');
    }
}

function previewBlogPost() {
    const title = document.getElementById('blogTitle').value.trim();
    if (!title) { showToast('Add a title first.', 'error'); return; }
    // Temporarily save and open
    const tempId = editingBlogId || 'preview_' + Date.now();
    const posts = loadBlogPosts();
    const existing = posts.find(p => p.id === tempId);
    const postData = {
        id: tempId,
        title: title,
        category: document.getElementById('blogCategory').value.trim(),
        date: document.getElementById('blogDate').value,
        coverImage: document.getElementById('blogCover').value.trim(),
        content: document.getElementById('blogContent').value,
        published: true,
        updatedAt: new Date().toISOString()
    };
    if (existing) {
        const idx = posts.indexOf(existing);
        posts[idx] = { ...existing, ...postData };
    } else {
        postData.createdAt = new Date().toISOString();
        posts.unshift(postData);
    }
    saveBlogPosts(posts);
    window.open('blog-post.html?id=' + tempId, '_blank');
}

function showToast(msg, type) {
    const toast = document.getElementById('toast');
    const icon = toast.querySelector('i');
    document.getElementById('toastMsg').textContent = msg;
    toast.className = 'toast show ' + type;
    icon.className = type === 'success' ? 'fas fa-check-circle' : 'fas fa-exclamation-circle';
    setTimeout(() => toast.classList.remove('show'), 3000);
}

function escHtml(str) {
    if (!str) return '';
    return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
}

// ============================================================
// INIT
// ============================================================
document.addEventListener('DOMContentLoaded', () => {
    loadData();
    populateForms();
    renderBlogList();
    checkSession();

    // Sidebar nav
    document.querySelectorAll('.sidebar-nav a').forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            switchPanel(link.dataset.panel);
        });
    });

    // Auto-save indicator on input change
    document.querySelectorAll('input, textarea').forEach(el => {
        el.addEventListener('input', markUnsaved);
    });
});
</script>

</body>
</html>
